Users can optionally write \mf~output to binary files.  There are several different types of binary output files.  The first type is new to MODFLOW and is called a binary grid file.  The binary grid file contains all of the information necessary for a post-processing program to quickly reconstruct the the model grid and understand how cells are connected within the grid.  The option to specify an IDOMAIN array for DIS and DISV grids may result in cells being connected across model layers.  For this reason, cell connectivity information is written to the binary grid file. The second type of binary file is one that contains simulated results, such as head.  Simulated flows are written to a third type of binary file, called a budget file.  The budget file contains simulated flows between connected cells and flows from stress packages.  Lastly, observations can also be written to binary output files.

All floating point variables are written to the binary output files as DOUBLE PRECISION Fortran variables. Integer variables are written to the output files as Fortran integer variables. Some variables are character strings and are indicated as so in the following descriptions.

The file formats for the binary files are described in the following sections. The frequency of output and the types of output files that are created is described in the Output Control Option and in the individual package input files.

\newpage
\subsection{Binary Grid File}
\mf~writes a binary grid file that can be used for post processing model results.  The file structure was designed to be self-documenting so that it can evolve if necessary.  The file name is assigned automatically by the program by adding ``.grb'' to the end of the discretization input file name.  The structure of the binary grid file depends on the type of discretization package that is used.  The following subsections summarize the binary grid file for the different grid types.  The red text is not written to the binary grid file, but is shown here to explain the file content.  The binary grid file is written for the GWF Model, but is not written for the GWT Model.

\newpage
\subsubsection{DIS Grids}

\vspace{5mm}
\noindent Header 1: \texttt{`GRID DIS'}  {\color{red} \footnotesize{CHARACTER(LEN=50)}} \\
\noindent Header 2: \texttt{`VERSION 1'}  {\color{red} \footnotesize{CHARACTER(LEN=50)}} \\
\noindent Header 3: \texttt{`NTXT 16'} {\color{red} \footnotesize{CHARACTER(LEN=50)}}\\
\noindent Header 4: \texttt{`LENTXT 100'} {\color{red} \footnotesize{CHARACTER(LEN=50)}}\\

\vspace{5mm}
\noindent Read \texttt{NTXT} strings of size \texttt{LENTXT}. Set the number of data records (\texttt{NDAT}) equal to number of lines that do not begin with \#.  \\
\noindent Definition 0: \texttt{`\#Comment ...'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}, comments not presently written} \\
\noindent Definition 1: \texttt{`NCELLS INTEGER NDIM 0 \# ncells'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 2: \texttt{`NLAY INTEGER NDIM 0 \# nlay'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 3: \texttt{`NROW INTEGER NDIM 0 \# nrow'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 4: \texttt{`NCOL INTEGER NDIM 0 \# ncol'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 5: \texttt{`NJA INTEGER NDIM 0 \# nja'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 6: \texttt{`XORIGIN DOUBLE NDIM 0 \# xorigin'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 7: \texttt{`YORIGIN DOUBLE NDIM 0 \# yorigin'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 8: \texttt{`ANGROT DOUBLE NDIM 0 \# angrot'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 9: \texttt{`DELR DOUBLE NDIM 1 ncol'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 10: \texttt{`DELC DOUBLE NDIM 1 nrow'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 11: \texttt{`TOP DOUBLE NDIM 1 nrow*ncol'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 12: \texttt{`BOTM DOUBLE NDIM 1 ncells'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 13: \texttt{`IA INTEGER NDIM 1 ncells+1'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 14: \texttt{`JA INTEGER NDIM 1 nja'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 15: \texttt{`IDOMAIN INTEGER NDIM 1 ncells'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 16: \texttt{`ICELLTYPE INTEGER NDIM 1 ncells'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\

\vspace{5mm}
\noindent Read \texttt{NDAT} data variables using the definitions defined above. \\
\noindent Record 1: \texttt{NCELLS} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 2: \texttt{NLAY} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 3: \texttt{NROW} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 4: \texttt{NCOL} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 5: \texttt{NJA} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 6: \texttt{XORIGIN} {\color{red} \footnotesize{DOUBLE}} \\
\noindent Record 7: \texttt{YORIGIN} {\color{red} \footnotesize{DOUBLE}} \\
\noindent Record 8: \texttt{ANGROT} {\color{red} \footnotesize{DOUBLE}} \\
\noindent Record 9: \texttt{DELR} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NCOL)}} \\
\noindent Record 10: \texttt{DELC} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE (NROW)}} \\
\noindent Record 11: \texttt{(TOP(J),J=1,NROW*NCOL)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NROW*NCOL)}} \\
\noindent Record 12: \texttt{(BOTM(J),J=1,NCELLS)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NCELLS)}} \\
\noindent Record 13: \texttt{(IA(J),J=1,NCELLS+1)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NCELLS+1)}} \\
\noindent Record 14: \texttt{(JA(J),J=1,NJA)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NJA)}} \\
\noindent Record 15: \texttt{(IDOMAIN(J),J=1,NCELLS)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NCELLS)}} \\
\noindent Record 16: \texttt{(ICELLTYPE(J),J=1,NCELLS)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NCELLS)}} \\

\newpage
\subsubsection{DISV Grids}

The binary grid file for DISV grids contains information on the vertices and which vertices comprise a cell.  The x, y coordinates for each vertex are stored in the VERTICES array.  The list of vertices that comprise all of the cells is stored in the JAVERT array.  The list of vertices for any cell can be found using the IAVERT array.  The following pseudocode shows how to loop through every cell in the DISV grid and obtain the cell vertices.  The list of vertices is ``closed'' for each cell in that the first listed vertex is equal to the last listed vertex.  

\begin{verbatim}
DO K = 1, NLAY
  DO N = 1, NCPL
    PRINT *, 'THIS IS CELL (LAYER, ICELL2D): ', K, N
    NVCELL = IAVERT(N+1) - IAVERT(N)
    PRINT*, 'NUMBER OF VERTICES FOR CELL IS', NVCELL
    DO IPOS = IAVERT(N), IAVERT(N + 1) - 1
      IVERT = JAVERT(IPOS)
      X = VERTICES(1,IVERT)
      Y = VERTICES(2,IVERT)
      PRINT *,'  VERTEX PAIR: ', X, Y
    ENDDO
  ENDDO
ENDDO
\end{verbatim}

The IA and JA arrays are also contained in the DISV binary grid file.  These arrays describe the cell connectivity.  Connections in the JA array correspond directly with the FLOW-JA-FACE record that is written to the budget file.

The content of the DISV binary grid file is as follows.

\vspace{5mm}
\noindent Header 1: \texttt{`GRID DISV'}  {\color{red} \footnotesize{CHARACTER(LEN=50)}} \\
\noindent Header 2: \texttt{`VERSION 1'}  {\color{red} \footnotesize{CHARACTER(LEN=50)}} \\
\noindent Header 3: \texttt{`NTXT 20'} {\color{red} \footnotesize{CHARACTER(LEN=50)}}\\
\noindent Header 4: \texttt{`LENTXT 100'} {\color{red} \footnotesize{CHARACTER(LEN=50)}}\\

\vspace{5mm}
\noindent Read \texttt{NTXT} strings of size \texttt{LENTXT}. Set the number of data records (\texttt{NDAT}) equal to number of lines that do not begin with \#.  \\
\noindent Definition 0: \texttt{`\#Comment ...'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}, comments not presently written} \\
\noindent Definition 1: \texttt{`NCELLS INTEGER NDIM 0 \# ncells'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 2: \texttt{`NLAY INTEGER NDIM 0 \# nlay'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 3: \texttt{`NCPL INTEGER NDIM 0 \# ncpl'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 4: \texttt{`NVERT INTEGER NDIM 0 \# nvert'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 5: \texttt{`NJAVERT INTEGER NDIM 0 \# njavert'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 6: \texttt{`NJA INTEGER NDIM 0 \# nja'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 7: \texttt{`XORIGIN DOUBLE NDIM 0 \# xorigin'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 8: \texttt{`YORIGIN DOUBLE NDIM 0 \# yorigin'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 9: \texttt{`ANGROT DOUBLE NDIM 0 \# angrot'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 10: \texttt{`TOP DOUBLE NDIM 1 ncpl'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 11: \texttt{`BOTM DOUBLE NDIM 1 ncells'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 12: \texttt{`VERTICES DOUBLE NDIM 2 2 nvert'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 13: \texttt{`CELLX DOUBLE NDIM 1 ncpl'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 14: \texttt{`CELLY DOUBLE NDIM 1 ncpl'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 15: \texttt{`IAVERT INTEGER NDIM 1 ncpl+1'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 16: \texttt{`JAVERT INTEGER NDIM 1 njavert'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 17: \texttt{`IA INTEGER NDIM 1 ncells+1'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 18: \texttt{`JA INTEGER NDIM 1 nja'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 19: \texttt{`IDOMAIN INTEGER NDIM 1 ncells'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 20: \texttt{`ICELLTYPE INTEGER NDIM 1 ncells'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\

\vspace{5mm}
\noindent Read \texttt{NDAT} data variables using the definitions defined above. \\
\noindent Record 1: \texttt{NCELLS} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 2: \texttt{NLAY} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 3: \texttt{NCPL} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 4: \texttt{NVERT} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 5: \texttt{NJAVERT} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 6: \texttt{NJA} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 7: \texttt{XORIGIN} {\color{red} \footnotesize{DOUBLE}} \\
\noindent Record 8: \texttt{YORIGIN} {\color{red} \footnotesize{DOUBLE}} \\
\noindent Record 9: \texttt{ANGROT} {\color{red} \footnotesize{DOUBLE}} \\
\noindent Record 10: \texttt{(TOP(J),J=1,NCPL)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NCPL)}} \\
\noindent Record 11: \texttt{((BOTM(J),J=1,NCELLS)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NCELLS)}} \\
\noindent Record 12: \texttt{((VERTICES(J,K),J=1,2),K=1,NVERT)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(2,NVERT)}} \\
\noindent Record 13: \texttt{(CELLX(J),J=1,NCPL)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NCPL)}}\\
\noindent Record 14: \texttt{(CELLY(J),J=1,NCPL)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NCPL)}} \\
\noindent Record 15: \texttt{(IAVERT(J),J=1,NCPL+1)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NCPL+1)}} \\
\noindent Record 16: \texttt{(JAVERT(J),J=1,NJAVERT)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NJAVERT)}} \\
\noindent Record 17: \texttt{(IA(J),J=1,NCELLS+1)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NCELLS+1)}} \\
\noindent Record 18: \texttt{(JA(J),J=1,NJA)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NJA)}} \\
\noindent Record 19: \texttt{(IDOMAIN(J),J=1,NCELLS)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NCELLS)}} \\
\noindent Record 20: \texttt{(ICELLTYPE(J),J=1,NCELLS)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NCELLS)}} \\

\newpage
\subsubsection{DISU Grids}

The binary grid file for DISU grids may contain information on the vertices and which vertices comprise a cell, but this depends on whether or not the user provided the information in the DISU Package.  This information is not required unless the XT3D or SAVE\_SPECIFIC\_DISCHARGE options are specified in the NPF Package.  If provided, the x, y coordinates for each vertex are stored in the VERTICES array.  The list of vertices that comprise all of the cells is stored in the JAVERT array.  The list of vertices for any cell can be found using the IAVERT array.  Pseudocode for looping through cells in the grid is listed above in the section on the binary grid file for the DISV Package.  As for the DISV binary grid file, the list of vertices is ``closed'' for each cell in that the first listed vertex is equal to the last listed vertex.

\vspace{5mm}
\noindent Header 1: \texttt{`GRID DISU'}  {\color{red} \footnotesize{CHARACTER(LEN=50)}} \\
\noindent Header 2: \texttt{`VERSION 1'}  {\color{red} \footnotesize{CHARACTER(LEN=50)}} \\
\noindent Header 3: \texttt{`NTXT 10'} or \texttt{`NTXT 15'} {\color{red} \footnotesize{CHARACTER(LEN=50)}}\\
\noindent Header 4: \texttt{`LENTXT 100'} {\color{red} \footnotesize{CHARACTER(LEN=50)}}\\

\vspace{5mm}
\noindent Read \texttt{NTXT} strings of size \texttt{LENTXT}. Set the number of data records (\texttt{NDAT}) equal to number of lines that do not begin with \#.  \\
\noindent Definition 0: \texttt{`\#Comment ...'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}, comments not presently written} \\
\noindent Definition 1: \texttt{`NODES INTEGER NDIM 0 \# nodes'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 2: \texttt{`NJA INTEGER NDIM 0 \# nja'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 3: \texttt{`XORIGIN DOUBLE NDIM 0 \# xorigin'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 4: \texttt{`YORIGIN DOUBLE NDIM 0 \# yorigin'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 5: \texttt{`ANGROT DOUBLE NDIM 0 \# angrot'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 6: \texttt{`TOP DOUBLE NDIM 1 nodes'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 7: \texttt{`BOT DOUBLE NDIM 1 nodes'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 8: \texttt{`IA INTEGER NDIM 1 ncells+1'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 9: \texttt{`JA INTEGER NDIM 1 nja'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 10: \texttt{`ICELLTYPE INTEGER NDIM 1 ncells'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\

\vspace{5mm}
\noindent If vertices are provided in the DISU Package, then 5 additional definitions are included: \\
\noindent Definition 11: \texttt{`VERTICES DOUBLE NDIM 2 2 nvert'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 12: \texttt{`CELLX DOUBLE NDIM 1 nodes'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 13: \texttt{`CELLY DOUBLE NDIM 1 nodes'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 14: \texttt{`IAVERT INTEGER NDIM 1 nodes+1'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\
\noindent Definition 15: \texttt{`JAVERT INTEGER NDIM 1 njavert'} {\color{red} \footnotesize{CHARACTER(LEN=LENTXT)}} \\

\vspace{5mm}
\noindent Read \texttt{NDAT} data variables using the definitions defined above. \\
\noindent Record 1: \texttt{NODES} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 2: \texttt{NJA} {\color{red} \footnotesize{INTEGER}} \\
\noindent Record 3: \texttt{XORIGIN} {\color{red} \footnotesize{DOUBLE}} \\
\noindent Record 4: \texttt{YORIGIN} {\color{red} \footnotesize{DOUBLE}} \\
\noindent Record 5: \texttt{ANGROT} {\color{red} \footnotesize{DOUBLE}} \\
\noindent Record 6: \texttt{(TOP(J),J=1,NODES)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NODES)}} \\
\noindent Record 7: \texttt{((BOT(J),J=1,NODES)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NODES)}} \\
\noindent Record 8: \texttt{(IA(J),J=1,NODES+1)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NODES+1)}} \\
\noindent Record 9: \texttt{(JA(J),J=1,NJA)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NJA)}} \\
\noindent Record 10: \texttt{(ICELLTYPE(J),J=1,NCELLS)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NCELLS)}} \\

\vspace{5mm}
\noindent If vertices are provided in the DISU Package, then 5 additional records are included: \\
\noindent Record 11: \texttt{((VERT(J,K),J=1,2),K=1,NVERT)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(2,NVERT)}} \\
\noindent Record 12: \texttt{(CELLX(J),J=1,NODES)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NODES)}}\\
\noindent Record 13: \texttt{(CELLY(J),J=1,NODES)} {\color{red} \footnotesize{DOUBLE PRECISION ARRAY SIZE(NODES)}} \\
\noindent Record 14: \texttt{(IAVERT(J),J=1,NODES+1)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NODES+1)}} \\
\noindent Record 15: \texttt{(JAVERT(J),J=1,NJAVERT)} {\color{red} \footnotesize{INTEGER ARRAY SIZE(NJAVERT)}} \\


\newpage
\subsection{Dependent Variable File}
In the present \mf version, the \texttt{TEXT} value is specified as ``HEAD'' for the GWF Model and ``CONCENTRATION'' for the GWT Model.  Cells that have been assigned an IDOMAIN value of zero or less are assigned a head value of $1.0$ x $10^{30}$.  Cells that have converted to dry are assigned a dry value of $-1.0$ x $10^{30}$.  The large negative value allows the results from a previous simulation to be used as starting heads for a subsequent simulation.  Cells assigned a large negative value as an initial condition will start the simulation as dry.  Note that the dry value is not used if the Newton-Raphson Formulation is active.  In this case, a dry cell will have a calculated head value that is below or at the bottom of the cell.

\subsubsection{DIS Grids}
For each stress period, time step, and layer for which data are saved to the binary output file, the following two records are written:

\vspace{5mm}
\noindent Record 1: \texttt{KSTP,KPER,PERTIM,TOTIM,TEXT,NCOL,NROW,ILAY} \\
\noindent Record 2: \texttt{((DATA(J,I,ILAY),J=1,NCOL),I=1,NROW)} \\

\vspace{5mm}
\noindent where

\begin{description} \itemsep0pt \parskip0pt \parsep0pt
\item \texttt{KSTP} is the time step number;
\item \texttt{KPER} is the stress period number;
\item \texttt{PERTIM} is the time value for the current stress period; 
\item \texttt{TOTIM} is the total simulation time;
\item \texttt{TEXT} is a character string (character*16);
\item \texttt{NCOL} is the number of columns;
\item \texttt{NROW} is the number of rows;
\item \texttt{ILAY} is the layer number; and
\item \texttt{DATA} is the head data of size (NCOL,NROW,NLAY).
\end{description}

\subsubsection{DISV Grids}
For each stress period, time step, and layer for which data are saved to the binary output file, the following two records are written:

\vspace{5mm}
\noindent Record 1: \texttt{KSTP,KPER,PERTIM,TOTIM,TEXT,NCPL,1,ILAY} \\
\noindent Record 2: \texttt{(DATA(J,ILAY),J=1,NCPL)} \\

\vspace{5mm}
\noindent where

\begin{description} \itemsep0pt \parskip0pt \parsep0pt
\item \texttt{KSTP} is the time step number;
\item \texttt{KPER} is the stress period number;
\item \texttt{PERTIM} is the time value for the current stress period; 
\item \texttt{TOTIM} is the total simulation time;
\item \texttt{TEXT} is a character string (character*16);
\item \texttt{NCPL} is the number of cells per layer;
\item \texttt{ILAY} is the layer number; and
\item \texttt{DATA} is the head data of size (NCPL,NLAY).
\end{description}

\newpage
\subsubsection{DISU Grids}
For each stress period, time step, and layer for which data are saved to the binary output file, the following two records are written:

\vspace{5mm}
\noindent Record 1: \texttt{KSTP,KPER,PERTIM,TOTIM,TEXT,NODES,1,1} \\
\noindent Record 2: \texttt{(DATA(N),N=1,NODES)} \\

\vspace{5mm}
\noindent where

\begin{description} \itemsep0pt \parskip0pt \parsep0pt
\item \texttt{KSTP} is the time step number;
\item \texttt{KPER} is the stress period number;
\item \texttt{PERTIM} is the time value for the current stress period; 
\item \texttt{TOTIM} is the total simulation time;
\item \texttt{TEXT} is a character string (character*16);
\item \texttt{NODES} is the number cells in the model grid;
\item \texttt{DATA} is unstructured head data of size (NODES).
\end{description}

\newpage
\subsubsection{Advanced Flow and Transport Packages}

\vspace{5mm}
The dependent variable can be saved to a binary file for the LAK, SFR, and MAW Packages of the GWF Model and for the LKT, SFT, MWT, and UZT Packages of the GWT Model.  Table~\ref{table:adpdv} shows the text identifier and description of the dependent variable for these packages.

\begin{longtable}{p{3cm} p{3.5 cm} p{5cm}}
\caption{Dependent variable written for advanced flow and transport packages} 
\tabularnewline
\hline
\textbf{Model/Package} & \textbf{TEXT} & \textbf{Description}  \\
\hline
\endhead
\hline
\endfoot
GWF/LAK & STAGE & Simulated lake stage  \\
GWF/SFR & STAGE & Simulated stream reach stage  \\
GWF/MAW & HEAD & Simulated well head  \\
GWT/LKT & CONCENTRATION & Simulated lake concentration  \\
GWT/SFT & CONCENTRATION & Simulated stream reach concentration  \\
GWT/MWT & CONCENTRATION & Simulated well concentration  \\
GWT/UZT & CONCENTRATION & Simulated unsaturated zone cell concentration  \\
\label{table:adpdv}
\end{longtable}



For each stress period, time step, and layer for which data are saved to the binary output file, the following two records are written:

\vspace{5mm}
\noindent Record 1: \texttt{KSTP,KPER,PERTIM,TOTIM,TEXT,MAXBOUND,1,1} \\
\noindent Record 2: \texttt{(DATA(N),N=1,MAXBOUND)} \\

\vspace{5mm}
\noindent where

\begin{description} \itemsep0pt \parskip0pt \parsep0pt
\item \texttt{KSTP} is the time step number;
\item \texttt{KPER} is the stress period number;
\item \texttt{PERTIM} is the time value for the current stress period; 
\item \texttt{TOTIM} is the total simulation time;
\item \texttt{TEXT} is a character string (\texttt{character*16});
\item \texttt{MAXBOUND} is the number advanced boundary items in the package;
\item \texttt{DATA} is unstructured dependent variable data of size (\texttt{MAXBOUND}).
\end{description}


\newpage
\subsection{Model Budget Files}
\mf can optionally write a budget file, also referred to as a cell-by-cell flow file.  The budget file is written in a binary format that can be post-processed using other software programs, such as ZONEBUDGET.  The budget file for the \mf models, such as the GWF and GWT Models, contains intercell water and solute flows, flows due to changes in storage, flows from the stress packages and advanced stress packages, and exchange flows with another model.  The intent of budget file is to contain all flow to and from any cell in the model.  Users must activate saving of flow terms in the Output Control Package and in the individual packages.  

The format for the budget file is different from the formats for previous MODFLOW versions.  Specifically, intercell flows are written in a different manner using a compressed sparse row storage scheme.  The record structure for the stress packages is also different and uses a method code 6, to distinguish it from the five method codes available in previous MODFLOW versions.  The new code 6 indicates that additional text identifiers are present, that auxiliary variables may be present, and that two identifying integer numbers are contained in the list (one for the node number of the GWF Model cell, and the other for an identifier to where the flow is from).  

\subsubsection{Format of Budget File}
The generalized form of the budget file is described so that utilities may be created to read the budget file.  Additional information about the content and the form of the content for different grid types is described in subsequent sections.

\vspace{5mm}
\noindent Record 1: \texttt{KSTP,KPER,TEXT,NDIM1,NDIM2,-NDIM3} \\
\noindent Record 2: \texttt{IMETH,DELT,PERTIM,TOTIM} \\

\begin{description}
\item \texttt{IMETH}=1: \textit{Read 1D array of size NDIM1*NDIM2*NDIM3.}\\
Record 3: \texttt{(DATA(J),J=1,NDIM1*NDIM2*NDIM3)}

\item \texttt{IMETH}=6: \textit{Read text identifiers, auxiliary text labels, and list of information.}\\
Record 3: \texttt{TXT1ID1}\\
Record 4: \texttt{TXT2ID1}\\
Record 5: \texttt{TXT1ID2}\\
Record 6: \texttt{TXT2ID2}\\
Record 7: \texttt{NDAT}\\
Record 8: \texttt{(AUXTXT(N),N=1,NDAT-1)}\\
Record 9: \texttt{NLIST}\\
Record 10: \texttt{((ID1(N),ID2(N),(DATA2D(I,N),I=1,NDAT)),N=1,NLIST)}\\
\end{description}

\noindent where

\begin{description} \itemsep0pt \parskip0pt \parsep0pt
\item \texttt{KSTP} is the integer time step number;
\item \texttt{KPER} is the integer stress period number;
\item \texttt{TEXT} is a character string (character*16) indicating the flow type;
\item \texttt{PERTIM} is the double precision time value for the current stress period; 
\item \texttt{TOTIM} is the double precision total simulation time;
\item \texttt{NDIM1} is the integer size of first dimension; 
\item \texttt{NDIM2} is the integer size of second dimension;
\item \texttt{NDIM3} is the integer size of third dimension;
\item \texttt{IMETH} is an integer code that specifies the form of the remaining data;
\item \texttt{DELT} is the double precision length of the timestep;
\item \texttt{PERTIM} is the double precision time value for the current stress period;
\item \texttt{TOTIM} is the double precision total simulation time;
\item \texttt{DATA} is a double precision array of budget values;
\item \texttt{TXT1ID1} is a character string (character*16) containing the first text identifier for information in ID1;
\item \texttt{TXT2ID1} is a character string (character*16) containing the second text identifier for information in ID1;
\item \texttt{TXT1ID2} is a character string (character*16) containing the model name for information in ID2;
\item \texttt{TXT2ID2} is a character string (character*16) containing the package or model name for information in ID2;
\item \texttt{NDAT} is the number of columns in DATA2D, which is the number of auxiliary values plus 1;
\item \texttt{AUXTXT} is an array of size NDAT - 1 containing character*16 text names for each auxiliary variable;
\item \texttt{NLIST} is the size of the list;
\item \texttt{ID1} is the first identifying number;
\item \texttt{ID2} is the second identifying number, and
\item \texttt{DATA2D} is a double precision 2D array of size (NDAT,NLIST).  The first column in DATA2D is the budget term; any remaining columns are auxiliary variable values.
\end{description}

\subsubsection{Intercell Flows}

\mf writes a special budget record for flow between connected cells. This record has a TEXT identifier equal to FLOW-JA-FACE. For this record (corresponding to Record 3 for IMETH=1), the total number of values is equal to NJA, which is the total number of connections.  For each cell, the number of connections is equal to the number of connections to adjacent cells plus one, to represent the cell itself. Therefore, this budget record corresponds to the JA array. A value of zero is written to the node positions in the FLOW-JA-FACE record.  The JA array that is written in the binary grid corresponds directly to the FLOW-JA-FACE record.

For regular MODFLOW grids, there are no longer records for FLOW RIGHT FACE, FLOW FRONT FACE,  and FLOW LOWER FACE.  Instead, intercell flows are written to the FLOW-JA-FACE record.  Writing FLOW-JA-FACE allows face flows to be specified in straightforward manner, particularly when the IDOMAIN capability is used to remove cells and specify vertical pass-through cells.  

The following pseudocode shows how to loop through and process intercell flows using the IA and JA arrays (which can be read from the binary grid file) and the FLOWJA array, which is written to the budget file.  For a cell (N) that has been eliminated with IDOMAIN, the value for IA(N) and IA(N+1) will be equal, indicating that there are no connections or flows for that cell.

\begin{verbatim}
DO N = 1, NCELLS
  PRINT *, 'THIS IS CELL: ', N
  NCON = IA(N+1) - IA(N) - 1
  IF(NCON<0) NCON=0
  PRINT*, 'NUMBER OF CONNECTED CELLS IS ', NCON
  DO IPOS = IA(N) + 1, IA(N + 1) - 1
    M = JA(IPOS)
    Q = FLOWJA(IPOS)
    PRINT *,'  N M Q: ', N,M,Q
  ENDDO
ENDDO
\end{verbatim}
 
\subsubsection{Variations for Discretization Types}
The format for the GWF and GWT Model budget files is the same no matter what discretization package is used; however, the variables may have different meanings depending on the grid type and the TEXT identifier.  If the TEXT identifier in Record 1 is FLOW-JA-FACE and IMETH is 1, then the DATA array contains intercell flows and is of size NJA.  If the TEXT identifier in Record 1 is something other than FLOW-JA-FACE (STO-SS or STO-SY, for example), then the dimension variables in Record 1 (NDIM1, NDIM2, and NDIM3) provide information about the size of the grid (table \ref{table:ndim}).  

\begin{longtable}{p{3cm} p{3cm} p{3cm} p{3cm}}
\caption{Budget file variations that depend on discretization package type} 
\tabularnewline
\hline
\textbf{Grid or Flow Type} & \textbf{NDIM1} & \textbf{NDIM2} & \textbf{NDIM3} \\
\hline
\endhead
\hline
\endfoot
DIS & NCOL & NROW & NLAY \\
DISV & NCPL & 1 & NLAY \\
DISU & NODES & 1 & 1 \\
FLOW-JA-FACE, IMETH=1 & NJA & 1 & 1 \\
\label{table:ndim}
\end{longtable}

\newpage
\subsubsection{Budget File Contents for the GWF Model}

The type of information that is written to the budget file for a GWF Model depends on the packages used for the model and whether or not the save flags are set.  Table \ref{table:gwfbud} contains a list of the types of information that may be contained in a GWF Model budget file.  In all cases, the flows in table \ref{table:gwfbud} are flows to or a from a GWF Model cell.  As described previously, intercell flows are written as FLOW-JA-FACE using IMETH=1.  If the model has an active Storage Package, then STORAGE-SS and STORAGE-SY are written to the budget file using IMETH=1. If the model has an active Skeletal Storage, Compaction, and Subsidence Package, then CSUB-CGELASTIC and CSUB-WATERCOMP are written to the budget file using IMETH=1.

The remaining flow terms in table \ref{table:gwfbud} are all written using IMETH=6.  When IMETH=6 is used, the records contain additional text descriptors and two identifying numbers.  For all records in the GWF Model budget file, TXT1ID1 is the name of the GWF Model and TXT2ID1 is also the name of the GWF Model.  These text identifiers describe what is contained in ID1.  For the GWF Model budget file, ID1 is the cell or node number in the GWF Model grid.  The second set of text identifiers refer to the information in ID2.  Unless noted otherwise in the description in table \ref{table:gwfbud}, TXT1ID2 is the name of the GWF Model, TXT2ID2 is the name of the package, and ID2 is the bound number in the package; for example, this is the first constant head cell, second constant head cell, and so forth.  

\begin{longtable}{p{3.5cm} p{2cm} p{9cm}}
\caption{Types of information that may be contained in the GWF Model budget file} 
\tabularnewline
\hline
\textbf{Flow Type (TEXT)} & \textbf{Method Code (IMETH)} & \textbf{Description} \\
\hline
\endhead
\hline
\endfoot
\texttt{FLOW-JA-FACE} & 1 & intercell flow; array of size(NJA) \\
\texttt{STO-SS} & 1 & confined storage; array of size (NCELLS) \\
\texttt{STO-SY} & 1 & unconfined storage; array of size (NCELLS) \\
\texttt{CSUB-CGELASTIC} & 1 & coarse-grained elastic storage from CSUB Package; array of size (NCELLS) \\
\texttt{CSUB-WATERCOMP} & 1 & water compressibility from CSUB Package; array of size (NCELLS) \\
\texttt{CSUB-ELASTIC} & 6 & interbed elastic storage from CSUB package; list of size(NINTERBEDS) \\
\texttt{CSUB-INELASTIC} & 6 & interbed inelastic storage from CSUB package; list of size(NINTERBEDS) \\
\texttt{CHD} & 6 & constant head flow\\
\texttt{WEL} & 6 & well flow \\
\texttt{WEL-TO-MVR} & 6 & well flow that is routed to Mover Package \\
\texttt{DRN} & 6 & drain flow \\
\texttt{DRN-TO-MVR} & 6 & drain flow that is routed to Mover Package\\
\texttt{RIV} & 6 & river leakage \\
\texttt{RIV-TO-MVR} & 6 & river leakage that is routed to Mover Package\\
\texttt{GHB} & 6 & general-head boundary flow \\
\texttt{GHB-TO-MVR} & 6 & general-head boundary flow that is routed to Mover Package\\
\texttt{RCH} & 6 & recharge flow \\
\texttt{EVT} & 6 & evapotranspiration flow \\
\texttt{MAW} & 6 & multi-aquifer well flow; ID2 contains the well number \\
\texttt{LAK} & 6 & lake leakage; ID2 contains the lake number \\
\texttt{SFR} & 6 & stream leakage; ID2 contains the stream reach number \\
\texttt{UZF-GWRCH} & 6 & water table recharge from UZF Package \\
\texttt{UZF-GWET} & 6 & water table evapotranspiration from UZF Package  \\
\texttt{UZF-GWD} & 6 & groundwater discharge to land surface from UZF Package \\
\texttt{UZF-GWD-TO-MVR} & 6 & groundwater discharge to land surface from UZF Package that is routed to Mover Package\\
\texttt{FLOW-JA-FACE} & 6 & flow to or from a cell in another GWF Model; TXT1ID1 is the name of the GWF Model described by this budget file, TXT2ID1 is the name of the GWF-GWF Exchange, TXT1ID2 is the name of the connected GWF Model, TXT2ID2 is the name of the GWF-GWF Exchange, and ID2 is the cell or node number of the cell in the connected model \\
\texttt{DATA-SPDIS} & 6 & specific discharge at the cell center.  The x, y, and z components are stored in auxiliary variables called ``qx'', ``qy'', and ``qz'', respectively.   The flow value written for each cell is zero.  The ``DATA'' prefix on the text identifier can be used by post-processors to recognize that the record does not contain a cell flow budget term. \\
\texttt{DATA-SAT} & 6 & cell saturation.  The cell saturation is stored in an auxiliary variable called ``sat''.   The flow value written for each cell is zero.  The ``DATA'' prefix on the text identifier can be used by post-processors to recognize that the record does not contain a cell flow budget term.  The cell saturation can be used by post-processors to determine how much of the cell is saturated without having to know the value for ICELLTYPE or the value for head.  If a cell is marked as confined (ICELLTYPE=0) then saturation is always one.  If ICELLTYPE is one, then saturation ranges between zero and one.  For Newton GWF simulations, saturation is zero if the head is below the cell bottom.
\label{table:gwfbud}
\end{longtable}

\newpage
\subsubsection{GWF Model CSUB Package}

\vspace{5mm}
For each stress period, time step, and compaction data type that is saved to the CSUB Package binary output files as \texttt{IMETH=1} budget file type. The compaction data that are written to the CSUB Package binary files are summarized in Tables~\ref{table:binarycsub}.

\begin{longtable}{p{3.5cm} p{2cm} p{9cm}}
	\caption{Data written to the CSUB Package compaction binary output files} 
	\tabularnewline
		\hline
		\textbf{Flow Type (TEXT)} & \textbf{Method Code (IMETH)} & \textbf{Description} \\
		\hline
	\endhead
		\hline
	\endfoot
	\texttt{CSUB-COMPACTION} & 1 & total compaction for cell; array of size (NCELLS) \\
	\texttt{CSUB-INELASTIC} & 1 & inelastic compaction for cell; array of size (NCELLS) \\
	\texttt{CSUB-ELASTIC} & 1 & elastic compaction for cell; array of size (NCELLS) \\
	\texttt{CSUB-INTERBED} & 1 & interbed compaction for cell; array of size (NCELLS) \\
	\texttt{CSUB-COARSE} & 1 & coarse-grained compaction for cell; array of size (NCELLS) \\
	\texttt{CSUB-ZDISPLACE} & 1 & z-displacement for cell; z-displacement of the upper most model cells represents subsidance at land-surface; array of size (NCELLS) \\
	\label{table:binarycsub}
\end{longtable}

\subsubsection{GWF Model LAK, MAW, SFR, and UZF Packages}

\vspace{5mm}
For each stress period, time step, and data type that is saved to the LAK, MAW, SFR, and UZF Packages binary output files as \texttt{IMETH=6} budget file type. For all advanced packages, \texttt{NDIM1} is equal to the number of nodes, \texttt{NDIM2} is equal to 1, and \texttt{NDIM3} is equal to -1. The data that are written to the LAK, MAW, SFR, and UZF Package binary files are summarized in Tables~\ref{table:binarylak} to~\ref{table:binaryuzf}, respectively.


% lake package binary budget output
\begin{longtable}{p{3.5cm} p{2cm} p{3.5cm} p{6.5cm}}
\caption{Data written to the LAK Package binary output file. Flow terms are listed in the order they are written to the LAK Package binary output file} \tabularnewline
\hline
\hline
\textbf{Flow term} & \textbf{IMETH} & \textbf{NDAT / NLIST} & \textbf{Description} \\
\hline
\endfirsthead

\hline
\hline
\textbf{Flow term} & \textbf{IMETH} & \textbf{NDAT / NLIST} & \textbf{Description} \\
\hline
\endhead

\hline
\endfoot

\texttt{FLOW-JA-FACE} & 6 & 1 / \texttt{2*nlen} & Connection flow from lake (\texttt{ID1}) to lake through a lake outlet to another lake (\texttt{ID2}). \texttt{nlen} is calculated as the sum of lake outlets that are connected to another lake (\texttt{lakeout} for a lake outlet is not equal to 0). \\
\texttt{GWF} & 6 & 2 / \texttt{maxbound} & Calculated flow from lake (\texttt{ID1}) to GWF cell (\texttt{ID2}). The lake connection-aquifer flow area (\texttt{FLOW-AREA}) is saved as an auxiliary data item for this flow term. \\
\texttt{EXT-INFLOW} & 6 & 1 / \texttt{nlakes} & Specified inflow to reach. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{RUNOFF} & 6 & 1 / \texttt{nlakes} & Specified runoff to reach. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{RAINFALL} & 6 & 1 / \texttt{nlakes} & Specified rainfall on reach. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{EVAPORATION} & 6 & 1 / \texttt{nlakes} & Calculated evaporation from lake. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{WITHDRAWAL} & 6 & 1 / \texttt{nlakes} & Specified withdrawal from lake. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{STORAGE} & 6 & 2 / \texttt{nlakes} & Calculated flow from storage for lake. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). The lake volume (\texttt{VOLUME}) is saved as an auxiliary data item for this flow term. \\
\texttt{CONSTANT} & 6 & 1 / \texttt{nlakes} & Calculated flow to maintain constant stage for lake. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{EXT-OUTFLOW} & 6 & 1 / \texttt{nlakes} & Calculated outflow to external boundaries (is nonzero for lakes with outlets not connected to another lake). The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{FROM-MVR} & 6 & 1 / \texttt{nlakes} & Calculated flow to lake from the MVR Package. Only saved if MVR Package is used in the LAK Package. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{TO-MVR} & 6 & 1 / \texttt{noutlets} & Calculated flow from a lake outlet to the MVR Package. Only saved if MVR Package is used in the LAK Package. The lake number \texttt{LAKEIN} for the connected outlet is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{AUXILIARY} & 6 & \texttt{naux}+1 / \texttt{nlakes} & Auxiliary variables, if specified in the LAK Package, are saved to this flow term. The first entry of the \texttt{DATA2D} column has a value of zero. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}).
\label{table:binarylak}
\end{longtable}


% multi-aquifer well package binary budget output
\newpage
\begin{longtable}{p{3.5cm} p{2cm} p{3.5cm} p{6.5cm}}
\caption{Data written to the MAW Package binary output file. Flow terms are listed in the order they are written to the MAW Package binary output file} \tabularnewline
\hline
\hline
\textbf{Flow term} & \textbf{IMETH} & \textbf{NDAT / NLIST} & \textbf{Description} \\
\hline
\endfirsthead

\hline
\hline
\textbf{Flow term} & \textbf{IMETH} & \textbf{NDAT / NLIST} & \textbf{Description} \\
\hline
\endhead

\hline
\endfoot

\texttt{GWF} & 6 & 2 / \texttt{maxbound} & Calculated flow from multi-aquifer well (\texttt{ID1}) to GWF cell (\texttt{ID2}). The multi-aquifer well-aquifer flow area (\texttt{FLOW-AREA}) is saved as an auxiliary data item for this flow term.\\
\texttt{RATE} & 6 & 1 / \texttt{nmawwells} & Calculated pumping rate from the multi-aquifer well. The multi-aquifer well number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{FW-RATE} & 6 & 1 / \texttt{nmawwells} & calculated flowing well discharge rate from the multi-aquifer well. Only saved if \texttt{FLOWING\_WELLS} is specified in the OPTIONS block. The multi-aquifer well number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{STORAGE} & 6 & 2 / \texttt{nmawwells} & Calculated flow from storage for multi-aquifer well. Only saved if the \texttt{NO\_WELL\_STORAGE} is not specified in the OPTIONS block. The multi-aquifer well number is written to (\texttt{ID1}) and (\texttt{ID2}). The multi-aquifer well volume (\texttt{VOLUME}) is saved as an auxiliary data item for this flow term. \\
\texttt{CONSTANT} & 6 & 1 / \texttt{nmawwells} & Calculated flow to maintain constant head in multi-aquifer well. The multi-aquifer well number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{FROM-MVR} & 6 & 1 / \texttt{nmawwells} & Calculated flow to lake from the MVR Package. Only saved if MVR Package is used in the MAW Package. The lake number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{RATE-TO-MVR} & 6 & 1 / \texttt{nmawwells} & Calculated pumping rate from the multi-aquifer well to the MVR Package. Only saved if MVR Package is used in the MAW Package. The multi-aquifer well number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{FW-RATE-TO-MVR} & 6 & 1 / \texttt{nmawwells} & Calculated flowing well flow from a multi-aquifer well to the MVR Package. Only saved if MVR Package is used in the MAW Package and the \texttt{FLOWING\_WELLS} is specified in the OPTIONS block. The multi-aquifer well number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{AUXILIARY} & 6 & \texttt{naux}+1 / \texttt{nmawwells} & Auxiliary variables, if specified in the MAW Package, are saved to this flow term. The first entry of the \texttt{DATA2D} column has a value of zero. The multi-aquifer well number is written to (\texttt{ID1}) and (\texttt{ID2}).
\label{table:binarymaw}
\end{longtable}


% streamflow routing package binary budget output
\newpage
\begin{longtable}{p{3.5cm} p{2cm} p{3.5cm} p{6.5cm}}
\caption{Data written to the SFR Package binary output file. Flow terms are listed in the order they are written to the SFR Package binary output file} \tabularnewline
\hline
\hline
\textbf{Flow term} & \textbf{IMETH} & \textbf{NDAT / NLIST} & \textbf{Description} \\
\hline
\endfirsthead

\hline
\hline
\textbf{Flow term} & \textbf{IMETH} & \textbf{NDAT / NLIST} & \textbf{Description} \\
\hline
\endhead

\hline
\endfoot

\texttt{FLOW-JA-FACE} & 6 & 2 / $\sum_{n=1}^{\texttt{maxbound}} \texttt{nconn}_n$  & Connection flow from reach (\texttt{ID1}) to unmanaged and managed (tributaries) connections (\texttt{ID2}). The cross-sectional flow area (\texttt{FLOW-AREA}) is saved as an auxiliary data item for this flow term. \\
\texttt{GWF} & 6 & 2 / \texttt{maxbound} & Calculated flow from reach (\texttt{ID1}) to GWF cell (\texttt{ID2}). The reach-aquifer flow area (\texttt{FLOW-AREA}) is saved as an auxiliary data item for this flow term.\\
\texttt{EXT-INFLOW} & 6 & 1 / \texttt{maxbound} & Specified inflow to reach. The reach number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{RUNOFF} & 6 & 1 / \texttt{maxbound} & Specified runoff to reach. The reach number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{RAIN} & 6 & 1 / \texttt{maxbound} & Specified rainfall on reach. The reach number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{EVAPORATION} & 6 & 1 / \texttt{maxbound} & Calculated evaporation from reach. The reach number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{EXT-OUTFLOW} & 6 & 1 / \texttt{maxbound} & Calculated outflow to external boundaries (is nonzero for reaches with no downstream connections). The reach number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{STORAGE} & 6 & 2 / \texttt{maxbound} & Calculated storage changes for each reach.  This value is always zero for the present implementation.  The water volume in the reach (\texttt{VOLUME}) is saved as an auxiliary data item for this flow term.  The reach number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{FROM-MVR} & 6 & 1 / \texttt{maxbound} & Calculated flow to reach from the MVR Package. Only saved if MVR Package is used in the SFR Package. The reach number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{TO-MVR} & 6 & 1 / \texttt{maxbound} & Calculated flow from reach to the MVR Package. Only saved if MVR Package is used in the SFR Package. The reach number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{AUXILIARY} & 6 & \texttt{naux}+1 / \texttt{maxbound} & Auxiliary variables, if specified in the SFR Package, are saved to this flow term. The first entry of the \texttt{DATA2D} column has a value of zero.  The reach number is written to (\texttt{ID1}) and (\texttt{ID2}). 
\label{table:binarysfr}
\end{longtable}


% unsaturated zone package binary budget output
\newpage
\begin{longtable}{p{3.5cm} p{2cm} p{3.5cm} p{6.5cm}}
\caption{Data written to the UZF Package binary output file. Flow terms are listed in the order they are written to the UZF Package binary output file} \tabularnewline
\hline
\hline
\textbf{Flow term} & \textbf{IMETH} & \textbf{NDAT / NLIST} & \textbf{Description} \\
\hline
\endfirsthead

\hline
\hline
\textbf{Flow term} & \textbf{IMETH} & \textbf{NDAT / NLIST} & \textbf{Description} \\
\hline
\endhead

\hline
\endfoot

\texttt{FLOW-JA-FACE} & 6 & 1 / \texttt{2*nlen} & Connection flow from UZF cell (\texttt{ID1}) to a connected UZF cell (\texttt{ID2}). \texttt{nlen} is calculated as the number of uzf cells with \texttt{vertcon} values greater than 0.\\
\texttt{GWF} & 6 & 2 / \texttt{maxbound} & Calculated flow from UZF cell (\texttt{ID1}) to GWF cell (\texttt{ID2}). The UZF cell-aquifer flow area (\texttt{FLOW-AREA}) is saved as an auxiliary data item for this flow term.\\
\texttt{INFILTRATION} & 6 & 1 / \texttt{maxbound} & Specified infiltration to UZF cell. The UZF cell number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{REJ-INF} & 6 & 1 / \texttt{maxbound} & Calculated rejected infiltration from the UZF cell. The UZF cell number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{UZET} & 6 & 1 / \texttt{maxbound} & Calculated evaporation from the UZF cell. The UZF cell number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{STORAGE} & 6 & 2 / \texttt{maxbound} & Calculated flow from storage for the UZF cell. The UZF cell number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{FROM-MVR} & 6 & 1 / \texttt{maxbound} & Calculated flow to the UZF cell from the MVR Package. Only saved if MVR Package is used in the UZF Package. The UZF cell number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{REJ-INF-TO-MVR} & 6 & 1 / \texttt{maxbound} & Calculated rejected infiltration flow from the UZF cell to the MVR Package. Only saved if MVR Package is used in the UZF Package. The UZF cell number is written to (\texttt{ID1}) and (\texttt{ID2}). \\
\texttt{AUXILIARY} & 6 & \texttt{naux}+1 / \texttt{maxbound} & Auxiliary variables, if specified in the UZF Package, are saved to this flow term. The first entry of the \texttt{DATA2D} column has a value of zero.  The UZF cell number is written to (\texttt{ID1}) and (\texttt{ID2}). 
\label{table:binaryuzf}
\end{longtable}


\newpage
\subsubsection{Budget File Contents for the GWT Model}

The type of information that is written to the budget file for a GWT Model depends on the packages used for the model and whether or not the save flags are set.  Table \ref{table:gwtbud} contains a list of the types of information that may be contained in a GWT Model budget file.  In all cases, the flows in table \ref{table:gwtbud} are solute mass flows (in mass per time) to or a from a GWT Model cell.  Intercell flows are written as FLOW-JA-FACE using IMETH=1.

The remaining flow terms in table \ref{table:gwtbud} are all written using IMETH=6.  When IMETH=6 is used, the records contain additional text descriptors and two identifying numbers.  For all records in the GWT Model budget file, TXT1ID1 is the name of the GWT Model and TXT2ID1 is also the name of the GWT Model.  These text identifiers describe what is contained in ID1.  For the GWT Model budget file, ID1 is the cell or node number in the GWT Model grid.  The second set of text identifiers refer to the information in ID2.  Unless noted otherwise in the description in table \ref{table:gwtbud}, TXT1ID2 is the name of the GWT Model, TXT2ID2 is the name of the package, and ID2 is the bound number in the package; for example, this is the first constant concentration cell, second constant concentration cell, and so forth.  

\begin{longtable}{p{3.5cm} p{2cm} p{9cm}}
\caption{Types of information that may be contained in the GWT Model budget file.  All terms represent solute flows in dimensions of mass per time} 
\tabularnewline
\hline
\textbf{Flow Type (TEXT)} & \textbf{Method Code (IMETH)} & \textbf{Description} \\
\hline
\endhead
\hline
\endfoot
\texttt{FLOW-JA-FACE} & 1 & intercell solute flow due to advection and dispersion; array of size(NJA) \\
\texttt{STORAGE-AQUEOUS} & 1 & solute aqueous storage; array of size (NCELLS) \\
\texttt{DECAY-AQUEOUS} & 1 & solute aqueous decay; array of size (NCELLS) \\
\texttt{STORAGE-SORBED} & 1 & solute sorbed storage; array of size (NCELLS) \\
\texttt{DECAY-SORBED} & 1 & solute sorbed decay; array of size (NCELLS) \\
\texttt{SOURCE-SINK MIX} & 6 & mass flow from SSM sources and sinks \\
\texttt{CNC} & 6 & mass flow for constant-concentration cells \\
\texttt{SRC} & 6 & mass flow for specified mass source cells \\
\texttt{LKT} & 6 & mass flow between lake and aquifer \\
\texttt{SFT} & 6 & mass flow between stream and aquifer \\
\texttt{MWT} & 6 & mass flow between multi-aquifer well and aquifer \\
\texttt{UZT} & 6 & mass flow between unsaturated zone cell and aquifer \\
\texttt{IST} & 6 & mass flow between mobile and immobile domain \\
\texttt{FLOW-JA-FACE} & 6 & flow to or from a cell in another GWT Model (note that this is not implemented yet for the GWT Model); TXT1ID1 is the name of the GWT Model described by this budget file, TXT2ID1 is the name of the GWF-GWF Exchange, TXT1ID2 is the name of the connected GWT Model, TXT2ID2 is the name of the GWT-GWT Exchange, and ID2 is the cell or node number of the cell in the connected model \\
\label{table:gwtbud}
\end{longtable}

\subsubsection{GWT Model LKT, MWT, SFT, and UZT Packages}

\vspace{5mm}
For each stress period, time step, and data type that is saved to theLKT, MWT, SFT, and UZT Packages binary output files as \texttt{IMETH=6} budget file type. For all advanced transport packages, \texttt{NDIM1} is equal to the number of nodes, \texttt{NDIM2} is equal to 1, and \texttt{NDIM3} is equal to -1. The data that are written to the LKT, MWT, SFT, and UZT Package binary files are mass flows with entries similar to those listed in Tables~\ref{table:binarylak} to~\ref{table:binaryuzf} for the advanced flow packages.


\newpage
\subsection{Observation Output File}

When the BINARY option is used to open an observation output file (see section ``Observation (OBS) Utility''), the output file has the following form. Record 1 has a length of 100 bytes.

\vspace{5mm}
\noindent Record 1: \texttt{TYPE, PRECISION, LENOBSNAME} \textit{(Record 1 includes 85 blanks following LENOBSNAME.)} \\
\noindent Record 2: \texttt{NOBS} \\
\noindent Record 3: \texttt{OBSNAME(1),  OBSNAME(2), ..., OBSNAME(NOBS)} \\

\vspace{12pt}
\noindent \textbf{Repeat for each time step.}

\vspace{12pt}
\noindent Record 4: \texttt{TIME, SIMVALUE(1), SIMVALUE(2), ..., SIMVALUE(NOBS)} \\
 
\vspace{12pt}
\noindent where

\begin{description} \itemsep0pt \parskip0pt \parsep0pt
\item \texttt{TYPE} (bytes 1--4 of Record 1) is ``cont `` ---  ``cont'' indicates the file contains continuous observations;
\item \texttt{PRECISION} (bytes 6--11 of Record 1) will always be ``double'' to indicate that floating-point values are written in double precision (8 bytes);
\item \texttt{LENOBSNAME} (bytes 12--15 of Record 1) is an integer indicating the number of characters used to store each observation name in following records (in the initial release of MODFLOW~6, LENOBSNAME equals 40);
\item \texttt{NOBS} (4-byte integer) is the number of observations recorded in the file;
\item \texttt{OBSNAME} (LENOBSNAME bytes) is an observation name;
\item \texttt{TIME} (floating-point) is the simulation time; and
\item \texttt{SIMVALUE} (floating-point) is the simulated value.
\end{description}
